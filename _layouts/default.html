<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
      {% if page.title %}
        {{ page.title }} |
      {% endif %}
      {{ site.title }}</title>
    <meta name="description" content="{{ site.description }}">
    <link
      rel="icon"
      type="image/x-icon"
      href="{{ '/assets/favicon.ico' | relative_url }}">
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="{{ '/assets/favicon-32x32.png' | relative_url }}">
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="{{ '/assets/favicon-16x16.png' | relative_url }}">
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="{{ '/assets/apple-touch-icon.png' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    {% feed_meta %}
    <script>
          (function() {
      const theme = localStorage.getItem('theme') || 'auto';
      document.documentElement.setAttribute('data-theme', theme);
          })();
    </script>
  </head>
  <body>
    <nav class="top-nav">
      <a href="{{ '/' | relative_url }}" class="nav-link">Home</a>
      <a href="{{ '/about/' | relative_url }}" class="nav-link">About</a>
      <button class="theme-toggle" aria-label="Toggle theme">
        <i class="fas fa-moon"></i>
        <i class="fas fa-sun"></i>
      </button>
    </nav>
    {{ content }}
    <div class="theme-transition"></div>
    <script>
      (function() {
        const toggle = document.querySelector('.theme-toggle');
        const html = document.documentElement;
        const overlay = document.querySelector('.theme-transition');
        
        function getEffectiveTheme() {
          const current = html.getAttribute('data-theme');
          if (current === 'auto') {
            return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
          }
          return current;
        }
        
        toggle.addEventListener('click', function(e) {
          const effective = getEffectiveTheme();
          const newTheme = effective === 'dark' ? 'light' : 'dark';
          
          // Get button center position
          const rect = toggle.getBoundingClientRect();
          const x = rect.left + rect.width / 2;
          const y = rect.top + rect.height / 2;
          
          // Set position and start animation
          overlay.style.setProperty('--x', x + 'px');
          overlay.style.setProperty('--y', y + 'px');
          overlay.className = 'theme-transition ' + newTheme + ' expanding';
          
          // Change theme near the start
          setTimeout(() => {
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
          }, 100);
          
          // Clean up after animation
          setTimeout(() => {
            overlay.className = 'theme-transition';
          }, 600);
        });
      })();
    </script>
  </body>
</html>
